---
title: 零散学习
date: 2020-03-23 21:11:55
tags:
    杂
typora-root-url: ./
---

# 1、  医疗设备中的安全漏洞

Aamir Lakhani认为：“来自这些泄露数据库的病患个人身份识别信息（PII）非常有价值，这些信息包括用户的姓名、家庭住址、信用卡信息和手机账户信息等等，这些都是网络犯罪分子严重的香饽饽。”

Lakhani还专门指出了安全研究专家在Fujifilm FCR Capsula X/Carbon X设备中发现的一个关键安全漏洞（CVE-2019-10950），而这种设备主要用于X射线等诊断数据的成像显示。这个严重的安全漏洞将允许远程攻击者通过发送精心构建的恶意请求来绕过目标设备的安全限制，该漏洞是由不安全的Telnet服务中不正确的访问控制所造成的。这个漏洞将允许攻击者访问目标设备的底层操作系统，并允许攻击者修改X光的检查和诊断结果，并最终导致正在查看X光检查结果的医生对患者的健康问题作出错误的诊断。

akhani表示，他们还在某款智能家庭血糖监测仪中发现了一个安全漏洞，这种监测仪可以帮助糖尿病患者测量自己的血糖水平。安全研究人员在对这款智能家庭血糖监测仪进行了仔细分析研究之后，发现这款设备与智能手机应用程序之间的通信是通过NFC实现的，但这种通信方式没有实现任何的身份认证机制，这也就意味着任何人都可以与目标设备进行配对，并查看设备与智能手机之间传输的数据，其中包括佩戴监测仪的事件、目标用户的血糖水平等等。不过研究人员目前已经将这个漏洞上报给了设备制造厂商，广大用户无需过多担心。

# 2、  CVE-2020-0787：未公开RPC函数中的提权漏洞分析

本文介绍了我在Background Intelligent Transfer Service（BITS，后台智能传输服务）中发现的一个任意文件移动漏洞，这是Windows 10中的一个特权文件操作滥用问题。

太厉害了，逆向工程，通过逻辑的不合理性，进行大胆推测，再在不合理的基础上进行其他的关联操作，从而做到提权

# 3、  任意用户密码重置的10种姿势

````
1） 验证码不失效
2） 验证码直接返回
3） 验证码未绑定用户
4） 修改接收的手机或邮箱
5） 本地验证绕过
6） 跳过验证步骤
7） 未校验用户字段的值
8） 修改密码处ID可替换
9） cookie值可替换
10）修改信息时替换字段
````

# 4、  我遇到的实战渗透

信息收集网站：感觉这网站  https://scan.top15.cn/web/ 

# 5、  hexo+GitHub的blog搭建

1、 环境准备：git、node.js、hexo、GitHub账号

1） 安装git、node.js软件到本地，下载exe安装文件，然后安装就可以

2） 查看git是否安装成功，在git bash（此后命令均在此输入）中输入 git –version

3） 查看hexo是否安装成功，输入 hexo -v

4） 注册github账号，并建立repository，注意一定要是公共的

2、 hexo搭建

1） 新建一个文件夹，并命令cd进入此文件夹

2） 开始安装Hexo，输入：npm install hexo -g

3） 检查hexo是否安装成功，输入：hexo -v

4） 初始化该文件夹，输入：hexo init （此后想重新搭建，从这一步开始就可以）看到后面的“Start blogging with Hexo！”就说明初始化好了

5） 输入npm install，安装所需要的组件

6） 安装好后，执行以下命令：（1）hexo g #generate 生成静态文件 （2）hexo s #server 启动服务器。默认情况下，访问网址为： http://localhost:4000/

3、 ssh配置 

1） 在Git Bash输入以下指令（任意位置点击鼠标右键），检查是否已经存在了SSH keys。

ls -al ~/.ssh

2） 如果不存在就没有关系，如果存在的话，直接删除.ssh文件夹里面所有文件：

![clip_image001-1584952379327](/blog.github.io/images/clip_image001-1584952379327.png)

3） 输入以下指令（邮箱就是你注册Github时候的邮箱）后，回车（不停回车，不用输入任何东西）：

`ssh-keygen -t rsa -C angelen10@163.com`

4） 进入GitHub，在设置中的在Settings sidebar那里，点击SSH keys，然后新增ssh

5） 在ssh中，粘贴C:\Users\user\.ssh下的id_rsa.pub文件中的所有内容

6） 在bash中输入 `ssh -T git@github.com` 验证是否连接成功

4、 _config.yml配置

1）在文档的最后的配置

````
deploy:
 type: git
 repository: git@github.com:GitHub用户名/repository名称.git
 branch: master
````

2）文档中URL的配置

url: 你的repository下的GitHub网址（是GitHub中repository的打开的网址，不是即将部署的你的博客的网址）

root: /blog.github.io

3）文档中site的配置

````
# Site
title: 标题
subtitle: 副标题
description: 描述
keywords: 
author: 
language: zh-CN
timezone: Asia/Shanghai
````

4）文档中，每行结尾要有空格，冒号后面要有空格

5、 同步GitHub

1） 执行：npm install hexo-deployer-git –save 安装hexo-deployer-git插件

2） hexo d -g 将文档部署到GitHub上

3） 打开GitHub中的网址，可以看到部署成功的blog

4） hexo g #generate 生成静态文件
 hexo s #server 启动服务器。在本地预览效果，默认情况下，访问网址为： http://localhost:4000/
 hexo d #deploy 部署网站同步到github。部署网站前，需要预先生成静态文件
 hexo clean #clean 清除缓存文件 (db.json) 和已生成的静态文件 (public)。

6、 设置主题

1） `git clone https://github.com/iissnan/hexo-theme-next themes/next`

2） 打开站点配置文件 _config.yml，找到 theme 字段，并将其值更改为 next。

theme: next

主题配置：

https://www.jianshu.com/p/208f2c4e3a16

https://www.jianshu.com/p/f054333ac9e6

https://www.jianshu.com/p/b520b49562b2

# 6、Burpsuite系列技巧 | 基础技巧（一）

```
Author：CoolCat&key
```

## 浅析Burpsuite作战工具

burp的`target`的sitemap中右键菜单中的Engagement tools，中文翻译为作战工具。

![main](/blog.github.io/images/main.png)

从上往下依次为

```
Search                        搜索
Find Comments                 查找注释
Find scripts                  查找js代码
Find references               查找引用
Analyze target                分析目标
Discover content              内容勘测
Schedule task                 定时任务
Simulate manual testing       人工模拟
```

### 0x01 Search 搜索(这个方法棒棒哒)

在选定的上右键打开后默认如下：

![search1](/blog.github.io/images/search1.png)

search强大的功能是使用**正则**进行搜索查询自己想要的内容。

贴一个很有用的正则：

```
(.user|pass|accessKeyId|accessKeySecret|secretToken|callback|admin|config|key|access|token?)
```

[![search2](/blog.github.io/images/search2.png)](https://vulkey.oss-cn-hangzhou.aliyuncs.com/2020-02-13/search2.png)

擅用该功能，在SRC捡洞可能可能只是一个习惯而已。（**比如每次准备关Burp之前考虑全选site map中所有的站点，再拿正则去尝试一下。**）

### 0x02 Find Comments 查找注释（Seach的一种）

选择目标右键打开后如下图：

![Comments1](/blog.github.io/images/Comments1.png)

![Comments2](/blog.github.io/images/Comments2.png)

可以理解为<u>Search功能的正则</u>写为:

```
<!--(.*?)-->
```

<span style="color:red">不同语言的注释不一样，burp内置的正则更为全面</span>。测试过程中适当看一下注释内容，没准一个未授权就出来了。

### 0x03 Find scripts 查找js代码

该功能处理`.js后缀`的文件之外，页面中script标签的内容也会<u>自动匹配</u>出来。<span style="color:red">等同于右键看完当前页面的js逻辑后在接着Ctrl F 搜.js然后继续看代码，在Burp里相对方便得多。</span>>

选择目标右键打开后如下图：

![script1](/blog.github.io/images/script1.png)

![script2](/blog.github.io/images/script2.png)

### 0x04 Find references 查找引用

如果用过[LinksDumper](https://github.com/TheKingOfDuck/myScripts/tree/master/LinksDumper)的话会发现Burp这个功能和它一模一样，**都是匹配出页面中存在的各类链接**。

默认自带的功能还有不少人是去用插件或者用独立的程序跑。burp自带的它不香咩？

选择目标右键打开后如下图：

![references1](/blog.github.io/images/references1.png)

![references2](/blog.github.io/images/references2.png)

### 0x05 Analyze target 分析目标（对快速查找参数有很大帮助）

选择目标右键打开后总共有四个页面:<span style="color:red">**总结页面、动态Urls、其他（静态）Url、参数统计**</span>

1.总结页面：假设拿到100个目标，筛选软柿子的时候通过总结页面判断一下，寻找**交互点多的站点/链接**进行单点突破，未尝不是一个高效的选择。

![Analyze1](/blog.github.io/images/Analyze1.png)

2.动态Urls：该功能可以快速筛选出**带外部参数的url**，并统计了参数的数量，秉着交互点越多可能存在的问题就越多的原则，筛选一下，效率++。

![Analyze2](/blog.github.io/images/Analyze2.png)

3.其他（静态）Url：该功能可以理解为Find references功能遍历出来所有的连接后再去除Dynamic URLs中带交互点的Url的结果。

![Analyze3](/blog.github.io/images/Analyze3.png)

4.参数统计：首先是统计了出现过那些参数，其次是这些参数在Url里面出现过次数。有了这个功能在瓶颈**渗透提取本站存在的参数**时根本不需要第三方插件工具辅助，直接复制name字段即可；某个参数存在漏洞后也可通过该功能查找其他可能存在相同问题的Url。

![Analyze4](/blog.github.io/images/Analyze4.png)

### 0x06 Discover content 内容勘测（目录扫描）

该功能秒杀一切**目录扫描**工具。

下面是关于如何巧用它去递归扫描站点备份的：

此前在米斯特`BurpSuite 插件生态开发组`里有提到想开发一款主动的备份扫描插件，寄生于`BurpSuite`强大的爬虫功能对每个目录/文件进行备份扫描。写一半发现`BurpSuite`本来就有这样的功能，只是很少有人用到罢了，本文仅对相关功能进行简要的分析以及优化。

#### 0x06_1 简介

正常访问时爬虫**被动**收集到的目录:

![eff8945b-a523-413a-951b-645552b448a3](/blog.github.io/images/eff8945b-a523-413a-951b-645552b448a3.jpg)

下面是本文的主角：

![43951031-06ef-4dc9-bfc2-b0b00cede03a](/blog.github.io/images/43951031-06ef-4dc9-bfc2-b0b00cede03a.jpg)

位于`Engagement tools` ==> `Discover content`

看看默认配置：

![42332280-aad3-436d-9f14-7bd8adadcdc4](/blog.github.io/images/42332280-aad3-436d-9f14-7bd8adadcdc4.jpg)

图中圈起来的第一部分默认勾选了burp内置的四个字典,第二个圈也是默认配置,其作用时从站点中提取各种目录并递归扫描,前面的配置可根据情况修改,后面不建议动它。

![1c7bdd51-7f22-4aae-b4d3-d3182c7a79f9](/blog.github.io/images/1c7bdd51-7f22-4aae-b4d3-d3182c7a79f9.jpg)

默认配置就是这四项了，下面具体分析一下他扫描的流量，取其精华。

#### 0x06_2 扫描分析（原理，非实操）

流程1:

![e16ed5cd-e230-4251-932f-c5dead9b9924](/blog.github.io/images/e16ed5cd-e230-4251-932f-c5dead9b9924.jpg)

先去除所有文件的后缀以及提取目录名当作文件扫一遍。

流程2:

![1da2ca8b-ee53-46e8-aa3c-97d3f77d9985](/blog.github.io/images/1da2ca8b-ee53-46e8-aa3c-97d3f77d9985.jpg)

在所有去了后缀的文件名后面加上`Test these extentsions`配置中的所有后缀并进行扫描，在已知站点语言的情况下此处明显多了很多无效流量。

流程3:

![0a2b7646-d46e-4d15-9854-1ab5f2740fd1](/blog.github.io/images/0a2b7646-d46e-4d15-9854-1ab5f2740fd1.jpg)

将流程1中的所有文件名当作目录扫一遍。

流程4:

[![5b4eca82-88dd-4c19-bf1e-f44986131d9c.jpg](/blog.github.io/images/5b4eca82-88dd-4c19-bf1e-f44986131d9c.jpg)](https://vulkey.oss-cn-hangzhou.aliyuncs.com/2020-02-13/5b4eca82-88dd-4c19-bf1e-f44986131d9c.jpg)

按照配置中Filenames中的字典顺序依次遍历并结合流程2的方式遍历文件。

流程5:

依次在每层目录执行一遍流程1-4，如果新目录或文件发现就添加到列队里面。

#### 0x06_3 优化扫描（操作）

![2fb555a0-a4d9-4c34-8d2b-d4dc9e4a683e](/blog.github.io/images/2fb555a0-a4d9-4c34-8d2b-d4dc9e4a683e.png)

缺陷很明显，仅仅三个目录三个文件总共请求了14048次，流量超过20M。

递归扫描产生的无效流量太多了。

首要原因出现在:

![d354e20c-8b49-49e3-9706-210dc440689f](/blog.github.io/images/d354e20c-8b49-49e3-9706-210dc440689f.jpg)

大多数时候，已知语言情况下完全没必要吧所有后缀都跑一遍，留特定语言以及相关后缀。如st2时加上.action/.do,流量去掉大半。

其次出现在:

![02d3d5c9-89e5-4ca4-96e2-68d36f1f062d](/blog.github.io/images/02d3d5c9-89e5-4ca4-96e2-68d36f1f062d.jpg)

此处主要针对扫备份，原生字典长这样:

```
bac
BAC
backup
BACKUP
bak
BAK
conf
cs
csproj
gz
inc
INC
ini
java
log
lst
old
OLD
orig
ORIG
sav
save
tar
temp
tmp
TMP
vb
vbproj
zip
$$$
-OLD
-old
0
1
~1
~bk
```

主要针对国外的站吧。这里提供一份。

```
txt
md
xml
db
7z
rar
zip
gz
tar
tar.gz
sql
bak
swp
old
properties
inc
ini
mdb
mdf
conf
config
log
rar
```

最后是字典的选择：

![a0e1fe7b-10c3-4288-8398-7684a17590a7](/blog.github.io/images/a0e1fe7b-10c3-4288-8398-7684a17590a7.png)

burp内置的4个字典内容重复率极高，比如about这个词在四个字典里都分别出现了…四个字典共3266个，去重后2265个。

结果保存在：

```
https://raw.githubusercontent.com/TheKingOfDuck/myScripts/master/burp_dir.txt
```

文件名方面推荐：

```
https://raw.githubusercontent.com/TheKingOfDuck/myScripts/master/burp_filenames.txt
```

![4e84215b-6f57-434d-8943-766a49cfe1d6](/blog.github.io/images/4e84215b-6f57-434d-8943-766a49cfe1d6.jpg)

如此一来在扫描目录的过程也可把备份一并扫了。

![010baabc-e71c-45b6-a34f-0263fd70699f](/blog.github.io/images/010baabc-e71c-45b6-a34f-0263fd70699f.jpg)

### 0x07 Schedule task 定时任务

选择目标右键打开后如下图：

![Schedule2](/blog.github.io/images/Schedule2.png)

![Schedule1](/blog.github.io/images/Schedule1.png)

### 0x08 Simulate manual testing 人工模拟

```
This function sends common test payloads to random URL s and parameters at irregular intervals, to generate traflic similar to that caused by manual penetration testing. Its only real use is to let you take a break from testing while still looking busy according to the server's logs. Only items which you selected in the site map will be requested.

此函数以不规则的间隔向随机URL和参数发送公共测试有效负载，以生成与手动渗透测试相似的流量。它唯一的真正用途是让您在根据服务器的日志看起来仍然很忙的时候暂停测试。将只请求您在站点地图中选择的项目。
```

正如功能描述中所说的，这是一个懒人挖洞选项。缺陷很明显，不会自动寻找并提交表单，只能依托于已有的表单/参数的基础上进行探测，相当于一款被动扫描器。结合**Discover content**使用，法力无边。

![Simulate1](/blog.github.io/images/Simulate1.png)

### 0x09 总结

熟练使用这些作战功能，扫描器从此是路人。

## 配置Intruder预定义Payload列表

预定义Payload列表在这里可以看见：

![15784875614943](/blog.github.io/images/15784875614943.jpg)

在Tab栏中有选项可以配置-`Configure predefined payload lists`：

![15784875896360](/blog.github.io/images/15784875896360.jpg)](https://vulkey.oss-cn-han

选择Payload列表目录（注：**需将常用的字典都放在一个目录里面**）：

![15784876498364](/blog.github.io/images/15784876498364.jpg)

## 自定义插入点进行扫描

将请求报文转发至Intruder，选择扫描的插入点：`Add$`

![15784879498028](/blog.github.io/images/15784879498028.jpg)

右键选择`Scan defined insertion points`

![15784879702356](/blog.github.io/images/15784879702356.jpg)

 

# 7、git预览部署脚本

1）预览脚本：

````
cp -r source/_posts/blog.github.io/images/*   source/images/
hexo clean
hexo s -d
````

2)部署脚本

````
cp -r source/_posts/blog.github.io/images/*   source/images/
hexo clean
hexo g -d
````

3)git 分支备份文件

